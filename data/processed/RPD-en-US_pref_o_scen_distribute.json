{"doc_name": "pref_o_scen_distribute.pdf", "doc_path": "data/raw/RPD-en-US/pref_o_scen_distribute.pdf", "num_pages": 3, "nonempty_pages": 3, "total_chars": 11259, "pages": [{"page": 1, "text": "2/4/26, 2:23 PM Usage scenario for distributing statements based on a preferences file - Jenski - Test portal- RPD Linux\nOverview\nOverview / Product overview / Features / Document processing features / Preference Management\n/ Usage scenario for distributing statements based on a preferences file\nUsage scenario for distributing statements based on a preferences file\nIn this scenario, a company changes their PDF print process to distribute statements to customers through multiple channels. Customers choose\nwhether their statements are printed, emailed, or displayed in their customer account on the company website. Because this information is not\npart of the data on the statement, the company exports the information from their customer database into a text file that contains headers. That\ntext file is used as a preferences file. The values in the file determine how each statement is distributed to the customer.\nThe preferences file contains customer account numbers, statement delivery preferences, email addresses, and marketing preferences. Customers\nchoose whether they want to receive offers from the company and third party vendors, offers only from the company, or no offers.\nBefore changing their process, the company prints all their statements using the EnhancePDFDocuments supplied workflow. The value of the\nIdentify PDF control file property on the IdentifyPDFDocuments step is /aiw/aiw1/control_files/EnhancePDFdocs.ctl. The value of\nthe Build PDF control file 1 property on the BuildPDFFromDocuments step also is /aiw/aiw1/control_files/EnhancePDFdocs.ctl.\nThe company uses the HotFolderPDF supplied input device with the Child workflow property set to EnhancePDFDocuments.\nThey use RICOH ProcessDirector Plug-in for Adobe Acrobat to identify the statements as individual documents in the production PDF file for each\njob. The data in each statement includes the account number.\nTo support the new process, the administrator:\nSets up custom document properties.\nCreates a document property mapping object.\nMakes the preferences file available to RICOH ProcessDirector.\nAdds the ApplyPreferences step to the EnhancePDFDocuments workflow.\nAdds steps that let the modified EnhancePDFDocuments workflow email statements to customers and display statements on the company\nwebsite.\nSetting up custom document properties\nTo set up custom document properties and add markup, the administrator:\nDefines and activates two custom document properties on the Administration ⇒ Objects ⇒ Custom properties page:\nDoc.Custom.AccountNumber, with Account number for the Field name\nDoc.Custom.PrefOffers, with Offers preference for the Field name\nLoads the updated RICOH ProcessDirector document properties to RICOH ProcessDirector Plug-in for Adobe Acrobat.\nUses the Define Document Property function in the plug-in to map account number data in the documents to the Account number document\nproperty (database name Doc.Custom.AccountNumber).\nDuring processing, the IdentifyPDFDocuments step in the workflow extracts the data for the Account number document property from each\ndocument in the PDF file for the job.\nNote:\nThe Define Document Property function cannot be used to map data to the Offers preference document property (database name\nDoc.Custom.PrefOffers) because the documents do not have that data. During processing, the ApplyPreferences step in the workflow\nuses the preferences file to populate the property values.\nUses the Save control file function in the plug-in to save the document property definition in the EnhancePDFdocs.ctl control file.\nSends the control file to the RICOH ProcessDirector server.\nCreating a document property mapping object\nThe administrator creates a CustomerPreferences document property mapping object with these values:\nIn the General section, the value of File type is CSV.\nIn the Property Mapping section, the values are:\nHeading Document propertyUsage\nAccount Number Account number Identify document\nOutput Type Output type Update property\nEmail Address Email address Update property\nOffers Offers preference Update property\n1 of 3"}, {"page": 2, "text": "2/4/26, 2:23 PM Usage scenario for distributing statements based on a preferences file - Jenski - Test portal- RPD Linux\nMaking the preferences file available to RICOH ProcessDirector\nTo make the preferences file available to RICOH ProcessDirector, the administrator:\nCreates an /aiw/aiw1/preferences directory for preferences files.\nAsks the department that provides the preferences file to name it EnhancePDFprefs.csv and write it to the /aiw/aiw1/preferences\ndirectory.\nMakes sure that the preferences file is ready for RICOH ProcessDirector to process:\nThe file must be in comma-separated values (CSV) format or tab-delimited format.\nThe columns of data must have the headings specified in the document property mapping object: Account Number, Output Type,\nEmail Address, and Offers.\nThis example shows a portion of the file:\nAccount Number,Output Type,Email Address,Offers\n2000144372,Print,,All\n2001144678,Print,,None\n2001154898,Email,m.lopez@isp1.com,Company\n2004187456,Print,,Company\n2007192007,Web,j.gomez@isp2.com,All\n2010197554,Email,s.jones@isp3.com,Company\n2010223114,Email,d.wilson@isp4.com,None\n2012234096,Web,a.larson@isp5.com,None\n2231547625,Print,,All\nModifying the workflow\nTo modify the EnhancePDFDocuments workflow that the company uses to print statements, the administrator:\nAdds an ApplyPreferences step after the IdentifyPDFDocuments step and sets values for the step properties:\nThe value of Preferences file is /aiw/aiw1/preferences/EnhancePDFprefs.csv.\nThe value of Property mapping is CustomerPreferences.\nAdds a GroupDocuments step after the ApplyPreferences step and sets the value of the Group first property to Output type.\nThe GroupDocuments step creates three groups of documents based on the values of the Output type document property. The values come\nfrom the EnhancePDFprefs.csv file: Print, Email, and Web.\nAdds a CreateJobsFromDocuments step to the workflow after the GroupDocuments step and sets the value of the Child workflow property to\nthe name of the current workflow.\nDisconnects the CreateJobsFromDocuments step from the BuildPDFFromDocuments step.\nAdds a condition on the connector between the SetJobPropsFromTextFile and CountPages steps. The rule on the connector is: Job number\nUnlike *.*\nThis rule lets you process parent and child jobs through different branches. Parent jobs, which do not have a . (period) in their names, use this\nbranch.\nAdds a SetDocPropsFromConditions step and connects the SetJobPropsFromTextFile step to it. The SetDocPropsFromConditions step starts a\nnew branch for child jobs. The connector does not have a rule. Child jobs, which have a decimal point in their job number, go down this\nbranch.\nThe SetDocPropsFromConditions step specifies a property conditions file that sets the Custom 1 job property (database name Job.Info.Attr1)\nbased on the value of the Output type document property from the preferences file. The property conditions file has this content:\n\"Doc.Pref.Output\",\"Job.Info.Attr1\"\n\"=Email\",\"Email\"\n\"=Print\",\"Print\"\n\"=Web\",\"Web\"\nConnects the SetDocPropsFromConditions step to the BuildPDFFromDocuments step.\nCreates a workflow branch for child jobs with statements to be printed by adding a condition on the existing connector from the\nBuildPDFFromDocuments step to the CountPages step. The rule on the connector is: Custom 1 = Print\nAdds an EmailDocuments step and connects the BuildPDFFromDocuments step to it. The EmailDocuments step sends each statement as a PDF\nfile to the email address for the customer.\nThe preferences file contains the customer email addresses.\nCreates a workflow branch for child jobs with statements to be emailed by adding a condition on the connector between the\nBuildPDFFromDocuments and EmailDocuments steps. The rule on the connector is: Custom 1 = Email\nAdds a RunExternalProgram step and connects the BuildPDFFromDocuments step to it. The RunExternalProgram step sends the statements to\nan external program that posts them on the company website.\nCreates a workflow branch for child jobs with statements to be posted on the company website by adding a condition on the connector\nbetween the BuildPDFFromDocuments and RunExternalProgram steps. The rule on the connector is: Custom 1 = Web\nAdds a WaitForRelatedJobs step between the PrintJobs step and the RetainCompletedJobs step.\nConnects the CreateJobsFromDocuments, EmailDocuments, and RunExternalProgram steps to the WaitForRelatedJobs step.\nProcessing jobs through the workflow\nAfter setting up the workflow and testing it, the administrator places the workflow in production.\nThe HotFolderPDF supplied input device receives a PDF job with statement documents and submits it to the EnhancePDFDocuments workflow.\nThe job goes through the workflow branch for parent jobs and moves to the ApplyPreferences step. RICOH ProcessDirector reads the information\nin the EnhancePDFprefs.csv file and creates three columns of data in the document properties file for the job. The columns contain values for\nthese properties:\n2 of 3"}, {"page": 3, "text": "2/4/26, 2:23 PM Usage scenario for distributing statements based on a preferences file - Jenski - Test portal- RPD Linux\nDoc.Pref.Output\nDoc.Email.Address\nDoc.Custom.PrefOffers\nThe job moves to the GroupDocuments step, which places each document in one of three groups based on the value of the Output type\nproperty.\nThe job moves to the CreateJobsFromDocuments step, which creates a child job for each group of documents and submits the child jobs to the\nsame workflow.\nThe child jobs go through the workflow branch for child jobs.\nWhen the child jobs reach the SetDocPropsFromConditions step, RICOH ProcessDirector sets the value of the Custom 1 job property:\nFor the child job with the Output type property set to Print, the Custom 1 job property is set to Print.\nFor the child job with the Output type property set to Email, the Custom 1 job property is set to Email.\nFor the child job with the Output type property set to Web, the Custom 1 job property is set to Web.\nRICOH ProcessDirector sends the child jobs to the print branch, email branch, or Web branch of the workflow based on the value of the Custom\n1 job property.\nThe child job with documents to be printed moves to the WaitForRelatedJobs step after the PrintJobs step.\nThe child job with email documents moves to the EmailDocuments step, and RICOH ProcessDirector uses the value specified for the Email\naddress property to email each policy as a PDF file to the customer.\nThe child job then moves to the WaitForRelatedJobs step.\nThe child job with Web documents moves to the RunExternalProgram step, which sends the statements to an external program that posts them\non the company website.\nThe child job then moves to the WaitForRelatedJobs step.\nWhen all of the child jobs reach the WaitForRelatedJobs step, the parent job and the child jobs start their retention period.\nNote:\nThis usage scenario shows how to add values for the Offer preferences property to the document properties file but does not use those\nvalues in the workflow. The company might use the property to determine whether to add an image with a marketing offer to the\ncustomer statement.\nParent topic: Preference Management\n3 of 3"}]}